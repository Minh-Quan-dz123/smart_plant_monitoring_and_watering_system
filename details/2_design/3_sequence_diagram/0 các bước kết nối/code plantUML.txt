@startuml
actor User
participant App as "Frontend (App)"
participant Backend
participant ESP as "ESP8266"

== Bước 1: Tạo vườn ==
User -> App : Click "Tạo vườn" và điền ESP ID (0001)
App -> Backend : POST /create/garden/{esp_id}
Backend -> Backend : Kiểm tra ESP ID đã tồn tại chưa
alt ESP ID đã tồn tại
    Backend --> App : Response fail
else ESP ID chưa tồn tại
    Backend --> App : Response success
end

== Bước 2: Kết nối Wi-Fi ==
User -> ESP : Kết nối Wi-Fi do ESP phát
User -> App : Nhập SSID và Password, click "Kết nối Wi-Fi"
App -> ESP : Gửi SSID & Password
ESP -> ESP : Kết nối Wi-Fi
ESP -> Backend : Thông báo đã kết nối

== Bước 3: Kiểm tra kết nối ESP8266 ==
User -> App : Vào App, kiểm tra kết nối ESP
App -> Backend : API kiểm tra esp_id
Backend -> ESP : Topic connect/{esp_id}/cmd/{"is_connect"}
alt ESP phản hồi trong 2s
    ESP -> Backend : Topic connect/{esp_id}/response/{"on"}
    Backend -> App : ESP đã kết nối
else ESP không phản hồi trong 2s
    Backend -> App : ESP không kết nối
end
@enduml
